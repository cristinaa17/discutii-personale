<div class="card shadow-sm p-4">

  <h4 class="mb-3">{{ isEditMode ? 'Editează colegul' : 'Adaugă coleg nou' }}</h4>

  <!--Poza-->
  <div class="col-12 text-center mb-4">
    <div class="w-100 d-flex justify-content-center mb-4">
      <ng-container *ngIf="form.photoUrl; else noPhoto">
        <img
          [src]="form.photoUrl"
          alt="Poză coleg"
          class="rounded-circle mb-2 shadow-sm"
          width="110"
          height="110"
          style="object-fit: cover;"
        />
      </ng-container>

      <ng-template #noPhoto>
        <div 
          class="rounded-circle bg-light d-flex align-items-center justify-content-center text-muted mb-2 shadow-sm"
          style="width: 110px; height: 100px; font-size: 14px; text-align: center; line-height: 1.2;">
          Fără poză
        </div>
      </ng-template>
    </div>

      <div *ngIf="form.photoUrl" class="mt-2">
        <button 
            type="button"
            class="btn btn-outline-danger btn-sm"
            (click)="removePhoto()">
            Șterge poza
          </button>
      </div>

      <input
        type="file"
        id="photoUploadInput"
        accept="image/*"
        (change)="onPhotoSelected($event)"
        style="display:none"
      />

      <div class="mt-3">
        <button 
          type="button" 
          class="btn btn-outline-primary btn-sm"
          (click)="triggerPhotoUpload()"
          >
          Încarcă poză
        </button>
      </div>  
  </div>

  <form class="row g-3">

    <!-- PerNr -->
    <div class="col-md-4">
      <label class="form-label">PerNR</label>
        <input 
          type="number"
          class="form-control"
          [(ngModel)]="form.perNr"
          name="pernr"
          #pernrRef="ngModel"
          min="1"
        />

      <div class="text-danger small mt-1" *ngIf="pernrRef.invalid && pernrRef.touched">
        PerNR nu poate fi negativ sau zero.
      </div>
    </div>

    <!--Nume-->
    <div class="col-md-8">
      <label class="form-label">
        Nume <span class="text-danger">*</span>
      </label>
      <input
        type="text"
        class="form-control"
        [(ngModel)]="form.nume"
        name="nume"
        #numeRef="ngModel"
        required
        minlength="2"
      />
      <div class="text-danger small mt-1" *ngIf="numeRef.invalid && numeRef.touched">
        <span *ngIf="numeRef.errors?.['required']">Numele este obligatoriu.</span>
        <span *ngIf="numeRef.errors?.['minlength']">Minim 2 caractere.</span>
      </div>
    </div>

    <!--Email-->
    <div class="col-md-6">
      <label class="form-label">Email</label>
      <input 
        type="email"
        class="form-control"
        [(ngModel)]="form.email" 
        name="email" 
        #emailRef="ngModel" 
        email
      />
      <div class="text-danger small mt-1" *ngIf="emailRef.invalid && emailRef.touched">
        Formatul emailului nu este valid.
      </div>
    </div>

    <!--Data angajarii-->
    <div class="col-md-6">
      <label class="form-label">Data angajării</label>
      <input type="date" class="form-control" [(ngModel)]="form.dataAngajarii" name="dataang"/>
    </div>

    <!--Data nasterii-->
    <div class="col-md-6">
      <label class="form-label">Data nașterii</label>
      <input type="date" class="form-control" [(ngModel)]="form.dataNasterii" name="datan"/>
    </div>

    <!--Gen-->
    <div class="col-md-6">
      <label class="form-label">Gen</label>
      <input type="text" class="form-control" [(ngModel)]="form.gen" name="gen"/>
    </div>

    <!--Oras-->
    <div class="col-md-6">
      <label class="form-label">Oraș</label>
      <input type="text" class="form-control" [(ngModel)]="form.oras" name="oras"/>
    </div>

    <!--Departament-->
    <div class="col-md-6">
      <label class="form-label">Departament</label>
      <input type="text" class="form-control" [(ngModel)]="form.departament" name="departament"/>
    </div>

    <!--Business Unit-->
    <div class="col-md-6">
      <label class="form-label">Business Unit</label>
      <input type="text" class="form-control" [(ngModel)]="form.businessUnit" name="bu"/>
    </div>

    <!--Norma-->
    <div class="col-md-4">
      <label class="form-label">Normă</label>
      <input type="number" class="form-control" [(ngModel)]="form.norma" name="norma"/>
    </div>

    <!--FTE-->
    <div class="col-md-4">
      <label class="form-label">FTE</label>
      <input type="number" class="form-control" [(ngModel)]="form.fte" name="fte"/>
    </div>

    <!--Forma colaborare-->
    <div class="col-md-6">
      <label class="form-label">Forma Colaborare</label>
      <input type="text" class="form-control" [(ngModel)]="form.formaColaborare" name="forma"/>
    </div>

    <!--Tip contract-->
    <div class="col-md-6">
      <label class="form-label">Tip Contract</label>
      <input type="text" class="form-control" [(ngModel)]="form.tipContract" name="tc"/>
    </div>

    <!--Functie-->
    <div class="col-md-6">
      <label class="form-label">Funcție</label>
      <input type="text" class="form-control" [(ngModel)]="form.functie" name="functie"/>
    </div>

    <!--Drept Concediu-->
    <div class="col-md-4">
      <label class="form-label">Drept Concediu</label>
      <input type="number" class="form-control" [(ngModel)]="form.dreptConcediu" name="dc"/>
    </div>

    <!--HR Manager-->
    <div class="col-md-6">
      <label class="form-label">HR Manager</label>
      <input type="text" class="form-control" [(ngModel)]="form.hrManager" name="hr"/>
    </div>

    <!--Project-->
    <div class="col-md-6">
      <label class="form-label">Project</label>
      <input type="text" class="form-control" [(ngModel)]="form.project" name="proj"/>
    </div>

    <!--Project Start Date-->
    <div class="col-md-6">
      <label class="form-label">Project Start Date</label>
      <input type="date" class="form-control" [(ngModel)]="form.projectStartDate" name="psd"/>
    </div>

    <!--Project End Date-->
    <div class="col-md-6">
      <label class="form-label">Project End Date</label>
      <input type="date" class="form-control" [(ngModel)]="form.projectEndDate" name="ped"/>
    </div>

    <!--Client-->
    <div class="col-md-6">
      <label class="form-label">Client</label>
      <input type="text" class="form-control" [(ngModel)]="form.client" name="client"/>
    </div>

    <!--Project Manager-->
    <div class="col-md-6">
      <label class="form-label">Project Manager</label>
      <input type="text" class="form-control" [(ngModel)]="form.projectManager" name="pm"/>
    </div>

    <!--Germana-->
    <div class="col-md-4">
      <label class="form-label">Germană</label>
      <select class="form-select" [(ngModel)]="form.german" name="german">
        <option value="">Selectează nivelul</option>
        <option *ngFor="let level of germanLevels" [value]="level">{{ level }}</option>
      </select>
    </div>

    <!--Engleza-->
    <div class="col-md-4">
      <label class="form-label">Engleză</label>
      <select class="form-select" [(ngModel)]="form.english"  name="english">
        <option value="">Selectează nivelul</option>
        <option *ngFor="let level of englishLevels" [value]="level">{{ level }}</option>
      </select>
    </div>

    <!--G-Level-->
    <div class="col-md-4">
      <label class="form-label">G-Level</label>
      <select class="form-select" [(ngModel)]="form.gLevel" name="glevel">
        <option value="">Selectează nivelul</option>
        <option *ngFor="let level of glevels" [value]="level">{{ level }}</option>
      </select>
    </div>

    <!--Skills-->
    <div class="col-12">
      <label class="form-label">Skills</label>
      <input type="text" class="form-control" [(ngModel)]="form.skills" name="skills"/>
    </div>

      <!--Butoane-->
      <div class="col-12 mt-3">
        <button type="button" class="btn btn-primary me-2" (click)="submit()">
          {{ isEditMode ? 'Salvează modificările' : 'Adaugă colegul' }}
        </button>

        <button type="button" class="btn btn-secondary" (click)="cancel.emit()">Renunță</button>
      </div>
  </form>
</div>
